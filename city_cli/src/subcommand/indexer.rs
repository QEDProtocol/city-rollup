use city_common::IndexerArgs;

use crate::build;
use crate::error::Result;

pub async fn run(args: IndexerArgs) -> Result<()> {
    print!(
        "
██╗     ██████╗      ██████╗ ██████╗ ██████╗ ██╗███╗   ██╗ █████╗ ██╗     ███████╗
██║     ╚════██╗    ██╔═══██╗██╔══██╗██╔══██╗██║████╗  ██║██╔══██╗██║     ██╔════╝
██║      █████╔╝    ██║   ██║██████╔╝██║  ██║██║██╔██╗ ██║███████║██║     ███████╗
██║     ██╔═══╝     ██║   ██║██╔══██╗██║  ██║██║██║╚██╗██║██╔══██║██║     ╚════██║
███████╗███████╗    ╚██████╔╝██║  ██║██████╔╝██║██║ ╚████║██║  ██║███████╗███████║
╚══════╝╚══════╝     ╚═════╝ ╚═╝  ╚═╝╚═════╝ ╚═╝╚═╝  ╚═══╝╚═╝  ╚═╝╚══════╝╚══════╝"
    );
    println!(
        "
                     ----------------------------------------
                    |           CityRollup v{}            |
                     ----------------------------------------
",
        build::PKG_VERSION
    );
    let indexer = city_indexer::Indexer::new(args).await?;
    indexer.listen().await?;
    Ok(())
}
